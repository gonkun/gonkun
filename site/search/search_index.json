{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Gon Personal Docs This documentation is a personal collection of notes, commands, and solutions related to the tools and technologies I use in my daily work. While some of the content may have been written quickly, it serves as a valuable reference for me, and I hope it can be useful to others as well.","title":"Home"},{"location":"#gon-personal-docs","text":"This documentation is a personal collection of notes, commands, and solutions related to the tools and technologies I use in my daily work. While some of the content may have been written quickly, it serves as a valuable reference for me, and I hope it can be useful to others as well.","title":"Gon Personal Docs"},{"location":"ai-for-devops/","text":"IA for DevOps K8sGPT https://k8sgpt.ai/ K8sGPT is a tool for scanning your kubernetes clusters, diagnosing and triaging issues. AI for Kubernetes with ChatGPT and k8sgpt Cast AI https://cast.ai/ Tool for cuts cloud costs, monitoring k8s costs and detect vulnerabilities. CAST.AI - Ahorrando dinero en Kubernetes Cost-Aware Kubernetes Cluster Autoscaling With CAST AI Automate BIG Savings For You Kubernetes Cluster Kubiya https://www.kubiya.ai/ ChatGPT for DevOps. A lot of useful integrations like GitHub, AWS, K8s, Terraform, etc... Meet your DevOps AI Assistant Kubiya Agents - Use-Case Review","title":"AI for DevOps"},{"location":"ai-for-devops/#ia-for-devops","text":"","title":"IA for DevOps"},{"location":"ai-for-devops/#k8sgpt","text":"https://k8sgpt.ai/ K8sGPT is a tool for scanning your kubernetes clusters, diagnosing and triaging issues. AI for Kubernetes with ChatGPT and k8sgpt","title":"K8sGPT"},{"location":"ai-for-devops/#cast-ai","text":"https://cast.ai/ Tool for cuts cloud costs, monitoring k8s costs and detect vulnerabilities. CAST.AI - Ahorrando dinero en Kubernetes Cost-Aware Kubernetes Cluster Autoscaling With CAST AI Automate BIG Savings For You Kubernetes Cluster","title":"Cast AI"},{"location":"ai-for-devops/#kubiya","text":"https://www.kubiya.ai/ ChatGPT for DevOps. A lot of useful integrations like GitHub, AWS, K8s, Terraform, etc... Meet your DevOps AI Assistant Kubiya Agents - Use-Case Review","title":"Kubiya"},{"location":"aws/","text":"","title":"AWS"},{"location":"bash/","text":"BASH Loops For Simple for loop for i in {1..10}; do echo $i done For loop to list files for i in $(ls); do echo $i done While Read a file line by line while read -r line; do echo $line done < file.txt Conditionals If Check if a file exists if [ -f file.txt ]; then echo \"file exists\" fi Check if a directory exists if [ -d /tmp ]; then echo \"directory exists\" fi Check if a variable is empty if [ -z \"\" ]; then echo \"variable is empty\" fi Check if a variable is not empty if [ -n \"hello\" ]; then echo \"variable is not empty\" fi Integer comparisons if [ 1 -eq 1 ]; then echo \"are equal\" fi if [ 1 -ne 2 ]; then echo \"are not equal\" fi if [ 1 -gt 0 ]; then echo \"is greater than\" fi if [ 1 -lt 2 ]; then echo \"is less than\" fi if [ 1 -ge 1 ]; then echo \"is greater or equal\" fi if [ 1 -le 1 ]; then echo \"is less or equal\" fi Variables Variable assignment and expansion variable=\"hello\" echo $variable echo ${variable} echo \"the value of the variable is ${variable}\" Arrays Array definition and usage # Define an array array=(\"one\" \"two\" \"three\") # Access individual elements echo ${array[0]} echo ${array[1]} echo ${array[2]} # Access all elements echo ${array[@]} # Get the number of elements in the array echo ${#array[@]} Functions Simple function definition function hello { echo \"hello\" } # Call the function hello Function with an argument function goodbye { echo \"goodbye $1\" } # Call the function with an argument goodbye world Awk Print the first column of a file awk '{print $1}' file.txt Print the last column of a file awk '{print $NF}' file.txt Print the first column from files containing a specific word grep -l \"hello\" * | xargs awk '{print $1}' Sed Replace the first occurrence of a string sed 's/hello/goodbye/' file.txt Replace all occurrences of a string (global replacement) sed 's/hello/goodbye/g' file.txt Replace a string and modify the file in-place sed -i 's/hello/goodbye/' file.txt Delete lines containing a specific string sed '/hello/d' file.txt Grep Search for a string in a single file grep \"hello\" file.txt Search for a string in all files in the current directory grep \"hello\" * Search for a string recursively starting from the current directory grep -r \"hello\" . Search recursively and display only the names of files that contain the string grep -rl \"hello\" . Find Find files by name find . -name \"file.txt\" Find directories by name find . -type d -name \"directory\" Find files by permissions find . -type f -perm 777 Find files modified within the last 7 days find . -type f -mtime -7 Find files larger than 1MB find . -type f -size +1M xargs Build and execute commands from standard input # Warning: This command can be dangerous. It will delete files listed by 'ls'. ls | xargs rm curl Make a simple GET request curl https://google.com Make a POST request with URL-encoded data curl -X POST -d \"param1=value1&param2=value2\" https://google.com Make a POST request with a JSON file curl -X POST -H \"Content-Type: application/json\" -d @file.json https://google.com","title":"BASH"},{"location":"bash/#bash","text":"","title":"BASH"},{"location":"bash/#loops","text":"","title":"Loops"},{"location":"bash/#for","text":"Simple for loop for i in {1..10}; do echo $i done For loop to list files for i in $(ls); do echo $i done","title":"For"},{"location":"bash/#while","text":"Read a file line by line while read -r line; do echo $line done < file.txt","title":"While"},{"location":"bash/#conditionals","text":"","title":"Conditionals"},{"location":"bash/#if","text":"Check if a file exists if [ -f file.txt ]; then echo \"file exists\" fi Check if a directory exists if [ -d /tmp ]; then echo \"directory exists\" fi Check if a variable is empty if [ -z \"\" ]; then echo \"variable is empty\" fi Check if a variable is not empty if [ -n \"hello\" ]; then echo \"variable is not empty\" fi Integer comparisons if [ 1 -eq 1 ]; then echo \"are equal\" fi if [ 1 -ne 2 ]; then echo \"are not equal\" fi if [ 1 -gt 0 ]; then echo \"is greater than\" fi if [ 1 -lt 2 ]; then echo \"is less than\" fi if [ 1 -ge 1 ]; then echo \"is greater or equal\" fi if [ 1 -le 1 ]; then echo \"is less or equal\" fi","title":"If"},{"location":"bash/#variables","text":"Variable assignment and expansion variable=\"hello\" echo $variable echo ${variable} echo \"the value of the variable is ${variable}\"","title":"Variables"},{"location":"bash/#arrays","text":"Array definition and usage # Define an array array=(\"one\" \"two\" \"three\") # Access individual elements echo ${array[0]} echo ${array[1]} echo ${array[2]} # Access all elements echo ${array[@]} # Get the number of elements in the array echo ${#array[@]}","title":"Arrays"},{"location":"bash/#functions","text":"Simple function definition function hello { echo \"hello\" } # Call the function hello Function with an argument function goodbye { echo \"goodbye $1\" } # Call the function with an argument goodbye world","title":"Functions"},{"location":"bash/#awk","text":"Print the first column of a file awk '{print $1}' file.txt Print the last column of a file awk '{print $NF}' file.txt Print the first column from files containing a specific word grep -l \"hello\" * | xargs awk '{print $1}'","title":"Awk"},{"location":"bash/#sed","text":"Replace the first occurrence of a string sed 's/hello/goodbye/' file.txt Replace all occurrences of a string (global replacement) sed 's/hello/goodbye/g' file.txt Replace a string and modify the file in-place sed -i 's/hello/goodbye/' file.txt Delete lines containing a specific string sed '/hello/d' file.txt","title":"Sed"},{"location":"bash/#grep","text":"Search for a string in a single file grep \"hello\" file.txt Search for a string in all files in the current directory grep \"hello\" * Search for a string recursively starting from the current directory grep -r \"hello\" . Search recursively and display only the names of files that contain the string grep -rl \"hello\" .","title":"Grep"},{"location":"bash/#find","text":"Find files by name find . -name \"file.txt\" Find directories by name find . -type d -name \"directory\" Find files by permissions find . -type f -perm 777 Find files modified within the last 7 days find . -type f -mtime -7 Find files larger than 1MB find . -type f -size +1M","title":"Find"},{"location":"bash/#xargs","text":"Build and execute commands from standard input # Warning: This command can be dangerous. It will delete files listed by 'ls'. ls | xargs rm","title":"xargs"},{"location":"bash/#curl","text":"Make a simple GET request curl https://google.com Make a POST request with URL-encoded data curl -X POST -d \"param1=value1&param2=value2\" https://google.com Make a POST request with a JSON file curl -X POST -H \"Content-Type: application/json\" -d @file.json https://google.com","title":"curl"},{"location":"cka_tips/","text":"CKA tips Alias Set a shorter alias for kubectl alias k=kubectl Autocompletion Enable kubectl autocompletion for the current session source <(kubectl completion bash) Enable kubectl autocompletion permanently echo \"source <(kubectl completion bash)\" >> ~/.bashrc Enable autocompletion for the 'k' alias source <(kubectl completion bash | sed 's/kubectl/k/g') echo \"source <(kubectl completion bash | sed 's/kubectl/k/g')\" >> ~/.bashrc Editor Set your preferred editor for kubectl edit export KUBE_EDITOR=\"nano\" Output Format Get pods with more details k get pods -o wide Get the full resource definition in YAML k get pod <pod-name> -o yaml --dry-run Generate the YAML for a resource without creating it k run nginx --image=nginx --dry-run=client -o yaml Force Deletion Force the deletion of a pod that is stuck terminating k delete pod <pod-name> --grace-period=0 --force","title":"CKA Tips"},{"location":"cka_tips/#cka-tips","text":"","title":"CKA tips"},{"location":"cka_tips/#alias","text":"Set a shorter alias for kubectl alias k=kubectl","title":"Alias"},{"location":"cka_tips/#autocompletion","text":"Enable kubectl autocompletion for the current session source <(kubectl completion bash) Enable kubectl autocompletion permanently echo \"source <(kubectl completion bash)\" >> ~/.bashrc Enable autocompletion for the 'k' alias source <(kubectl completion bash | sed 's/kubectl/k/g') echo \"source <(kubectl completion bash | sed 's/kubectl/k/g')\" >> ~/.bashrc","title":"Autocompletion"},{"location":"cka_tips/#editor","text":"Set your preferred editor for kubectl edit export KUBE_EDITOR=\"nano\"","title":"Editor"},{"location":"cka_tips/#output-format","text":"Get pods with more details k get pods -o wide Get the full resource definition in YAML k get pod <pod-name> -o yaml","title":"Output Format"},{"location":"cka_tips/#-dry-run","text":"Generate the YAML for a resource without creating it k run nginx --image=nginx --dry-run=client -o yaml","title":"--dry-run"},{"location":"cka_tips/#force-deletion","text":"Force the deletion of a pod that is stuck terminating k delete pod <pod-name> --grace-period=0 --force","title":"Force Deletion"},{"location":"dse/","text":"","title":"DataStax"},{"location":"github-actions/","text":"GitHub Actions Tutorials and Guides GitHub Actions Official Documentation GitHub Actions: Terraform deployments with a review of planned changes Tools and Projects Act: Run GitHub Actions locally","title":"GitHub Actions"},{"location":"github-actions/#github-actions","text":"","title":"GitHub Actions"},{"location":"github-actions/#tutorials-and-guides","text":"GitHub Actions Official Documentation GitHub Actions: Terraform deployments with a review of planned changes","title":"Tutorials and Guides"},{"location":"github-actions/#tools-and-projects","text":"Act: Run GitHub Actions locally","title":"Tools and Projects"},{"location":"help/","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Welcome to MkDocs"},{"location":"help/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"help/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"help/#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"istio/","text":"","title":"Istio"},{"location":"k8s/","text":"Kubernetes Common Commands Run pod kubectl run <pod_name> --image <image> -n <namespace> Run pod and passing a command kubectl run -i --tty <pod_name> --image=<image> -n <namespace> -- <command> Get info about cluster kubectl cluster-info Get all pods kubectl get pods -A Get resource yaml kubectl get <resource> -n <namespace> <resource_name> -o yaml Get list of CRD applied kubectl get customresourcedefinitions List pods Docker images in a specific namespace kubectl get pods -n <namespace> -o jsonpath=\"{.items[*].spec.containers[*].image}\" Restart all deployments in a namespace kubectl rollout restart deployment -n <namespace> List all running pods in a specific namespace kubectl get pods -n <namespace> --field-selector=status.phase=Running List all non-running pods in a specific namespace kubectl get pods -A --field-selector=status.phase!=Running | grep -v Complete Create tunnel to a service using port-forward (like a SSH tunnel) kubectl port-forward -n <namespace> svc/<service_name> <localhost_port>:<service_port> List all PVC associated with their respective pod kubectl get po -o json --all-namespaces | \\ jq -j '.items[] | \"\\(.metadata.namespace), \\(.metadata.name), \\(.spec.volumes[].persistentVolumeClaim.claimName)\\n\"' | \\ grep -v null List all pods with events related to them kubectl get pods --watch --output-watch-events -A List all events with filter \"type=Warning\" kubectl get events -w --field-selector=type=Warning -A List all environment variables of specific pod kubectl set env -n <namespace> pod/<podname> --list Advanced Commands Run pod multitool for testing/debugging on k8s kubectl run multitool --namespace <namespace> --image=wbitt/network-multitool:extra -it --tty --rm --restart=Never -- sh List of nodes and their memory size kubectl get no -o json | jq -r '.items | sort_by(.status.capacity.memory)[]|[.metadata.name,.status.capacity.memory]| @tsv' List of nodes and the number of pods running on them kubectl get pod -o json --all-namespaces | jq '.items | group_by(.spec.nodeName) | map({\"nodeName\": .[0].spec.nodeName, \"count\": length}) | sort_by(.count) List all pods sort by memory usage k top pods -A --sort-by='memory' List all pods sorted by cpu usage k top pods -A --sort-by='cpu' Sorting list of pods (in this case, by the number of restarts) kubectl get pods --sort-by=.status.containerStatuses[0].restartCount Print limits and requests for each pod kubectl get pods -n <namespace> -o=custom-columns='NAME:spec.containers[*].name,MEMREQ:spec.containers[*].resources.requests.memory,MEMLIM:spec.containers[*].resources.limits.memory,CPUREQ:spec.containers[*].resources.requests.cpu,CPULIM:spec.containers[*].resources.limits.cpu' Print all services and their respective nodePorts kubectl get --all-namespaces svc -o json | \\ jq -r '.items[] | [.metadata.name,([.spec.ports[].nodePort | tostring ] | join(\"|\"))]| @tsv' Copy secrets from a namespace to another kubectl get secrets -o json --namespace <namespace_source> | \\ jq '.items[].metadata.namespace = \"<namespace_destiny>\"' | \\ kubectl create -f - Logging Commands Kubectl Print logs with human-readable timestamp kubectl -n <namespace> logs -f <pod_name> --timestamps Getting logs from all pods using a label to filter kubectl -n <namespace> logs -f -l app=nginx Kubetail Tail logs specific container kubetail <pod_name> -c <container_name> Tail logs from all containers on specific namespace kubetail -n <namespace> Stern Tail logs all pods on specific namespace stern -n <namespace> . Tail logs all pods with excluded stern -n <namespace> --exclude-container <pattern_string> . Tail logs specific pods stern -n <namespace> --container <pattern_string> Definitions External DNS Service which manages DNS records, in our case, on Route53. External DNS check annotations on Service and Ingress objects. On UserTesting we configured External DNS just for checking annotations on Ingress objects. External DNS search domain names on annotations or host on rules and creates a register on Hosted Zones which we configure or matching with domain name which we configured. AWS Load Balancer Controller Service which manages Ingress and Services k8s objects. For Ingress it creates an ALB by default, but can be configured to create a NLB. For Service it creates NLB only, no ALB. We can configure the Load Balancer parameters using annotations . On the other hand, for configure Listener Rules we use the parameter rules of Ingress object. Emissary Ingress IT DOESN'T MANAGE LOAD BALANCER. It's a kind of application firewall. It routes requests using different paths. It works like a AWS Listener Rule but with a lot of extra options. Tutorials and Guides Local Cluster Create local cluster for gomelab with k3d Spin up a local cluster with k3d Exposing services in k3d with traefik Load Balancing Strategies Powerful Load Balancing Strategies: Kubernetes Gateway API Getting Started with Kubernetes Gateway API and Traefik Debugging Kubernetes Issues Debugging Kubernetes Issues in Production: A technical guide Ingresses Native EKS Ingress with AWS Load Balancer Controller Why I'm moving from Kubernetes Ingress to Gateway API Certificates Ingress + Cert-Manager DNS The life of a DNS query in Kubernetes Networking The Kubernetes Networking Guide An Illustrated Guide to Kubernetes Networking [Part 1] An Illustrated Guide to Kubernetes Networking [Part 2] An Illustrated Guide to Kubernetes Networking [Part 3] ALB Ingress Controller on AWS EKS What Actually Happens When You Publish a Container Port Secrets State of Kubernetes Secrets Management in 2022 How to Set External-Secrets with AWS How to Set External-Secrets with Hashicorp Vault Virtual Kubernetes Testing GitOps on Virtual Kubernetes Clusters with ArgoCD (Ephimeral k8s clusters) Troubleshooting How to identify and troubleshoot common Kubernetes errors","title":"Kubernetes"},{"location":"k8s/#kubernetes","text":"","title":"Kubernetes"},{"location":"k8s/#common-commands","text":"Run pod kubectl run <pod_name> --image <image> -n <namespace> Run pod and passing a command kubectl run -i --tty <pod_name> --image=<image> -n <namespace> -- <command> Get info about cluster kubectl cluster-info Get all pods kubectl get pods -A Get resource yaml kubectl get <resource> -n <namespace> <resource_name> -o yaml Get list of CRD applied kubectl get customresourcedefinitions List pods Docker images in a specific namespace kubectl get pods -n <namespace> -o jsonpath=\"{.items[*].spec.containers[*].image}\" Restart all deployments in a namespace kubectl rollout restart deployment -n <namespace> List all running pods in a specific namespace kubectl get pods -n <namespace> --field-selector=status.phase=Running List all non-running pods in a specific namespace kubectl get pods -A --field-selector=status.phase!=Running | grep -v Complete Create tunnel to a service using port-forward (like a SSH tunnel) kubectl port-forward -n <namespace> svc/<service_name> <localhost_port>:<service_port> List all PVC associated with their respective pod kubectl get po -o json --all-namespaces | \\ jq -j '.items[] | \"\\(.metadata.namespace), \\(.metadata.name), \\(.spec.volumes[].persistentVolumeClaim.claimName)\\n\"' | \\ grep -v null List all pods with events related to them kubectl get pods --watch --output-watch-events -A List all events with filter \"type=Warning\" kubectl get events -w --field-selector=type=Warning -A List all environment variables of specific pod kubectl set env -n <namespace> pod/<podname> --list","title":"Common Commands"},{"location":"k8s/#advanced-commands","text":"Run pod multitool for testing/debugging on k8s kubectl run multitool --namespace <namespace> --image=wbitt/network-multitool:extra -it --tty --rm --restart=Never -- sh List of nodes and their memory size kubectl get no -o json | jq -r '.items | sort_by(.status.capacity.memory)[]|[.metadata.name,.status.capacity.memory]| @tsv' List of nodes and the number of pods running on them kubectl get pod -o json --all-namespaces | jq '.items | group_by(.spec.nodeName) | map({\"nodeName\": .[0].spec.nodeName, \"count\": length}) | sort_by(.count) List all pods sort by memory usage k top pods -A --sort-by='memory' List all pods sorted by cpu usage k top pods -A --sort-by='cpu' Sorting list of pods (in this case, by the number of restarts) kubectl get pods --sort-by=.status.containerStatuses[0].restartCount Print limits and requests for each pod kubectl get pods -n <namespace> -o=custom-columns='NAME:spec.containers[*].name,MEMREQ:spec.containers[*].resources.requests.memory,MEMLIM:spec.containers[*].resources.limits.memory,CPUREQ:spec.containers[*].resources.requests.cpu,CPULIM:spec.containers[*].resources.limits.cpu' Print all services and their respective nodePorts kubectl get --all-namespaces svc -o json | \\ jq -r '.items[] | [.metadata.name,([.spec.ports[].nodePort | tostring ] | join(\"|\"))]| @tsv' Copy secrets from a namespace to another kubectl get secrets -o json --namespace <namespace_source> | \\ jq '.items[].metadata.namespace = \"<namespace_destiny>\"' | \\ kubectl create -f -","title":"Advanced Commands"},{"location":"k8s/#logging-commands","text":"","title":"Logging Commands"},{"location":"k8s/#kubectl","text":"Print logs with human-readable timestamp kubectl -n <namespace> logs -f <pod_name> --timestamps Getting logs from all pods using a label to filter kubectl -n <namespace> logs -f -l app=nginx","title":"Kubectl"},{"location":"k8s/#kubetail","text":"Tail logs specific container kubetail <pod_name> -c <container_name> Tail logs from all containers on specific namespace kubetail -n <namespace>","title":"Kubetail"},{"location":"k8s/#stern","text":"Tail logs all pods on specific namespace stern -n <namespace> . Tail logs all pods with excluded stern -n <namespace> --exclude-container <pattern_string> . Tail logs specific pods stern -n <namespace> --container <pattern_string>","title":"Stern"},{"location":"k8s/#definitions","text":"","title":"Definitions"},{"location":"k8s/#external-dns","text":"Service which manages DNS records, in our case, on Route53. External DNS check annotations on Service and Ingress objects. On UserTesting we configured External DNS just for checking annotations on Ingress objects. External DNS search domain names on annotations or host on rules and creates a register on Hosted Zones which we configure or matching with domain name which we configured.","title":"External DNS"},{"location":"k8s/#aws-load-balancer-controller","text":"Service which manages Ingress and Services k8s objects. For Ingress it creates an ALB by default, but can be configured to create a NLB. For Service it creates NLB only, no ALB. We can configure the Load Balancer parameters using annotations . On the other hand, for configure Listener Rules we use the parameter rules of Ingress object.","title":"AWS Load Balancer Controller"},{"location":"k8s/#emissary-ingress","text":"IT DOESN'T MANAGE LOAD BALANCER. It's a kind of application firewall. It routes requests using different paths. It works like a AWS Listener Rule but with a lot of extra options.","title":"Emissary Ingress"},{"location":"k8s/#tutorials-and-guides","text":"","title":"Tutorials and Guides"},{"location":"k8s/#local-cluster","text":"Create local cluster for gomelab with k3d Spin up a local cluster with k3d Exposing services in k3d with traefik","title":"Local Cluster"},{"location":"k8s/#load-balancing-strategies","text":"Powerful Load Balancing Strategies: Kubernetes Gateway API Getting Started with Kubernetes Gateway API and Traefik","title":"Load Balancing Strategies"},{"location":"k8s/#debugging-kubernetes-issues","text":"Debugging Kubernetes Issues in Production: A technical guide","title":"Debugging Kubernetes Issues"},{"location":"k8s/#ingresses","text":"Native EKS Ingress with AWS Load Balancer Controller Why I'm moving from Kubernetes Ingress to Gateway API","title":"Ingresses"},{"location":"k8s/#certificates","text":"Ingress + Cert-Manager","title":"Certificates"},{"location":"k8s/#dns","text":"The life of a DNS query in Kubernetes","title":"DNS"},{"location":"k8s/#networking","text":"The Kubernetes Networking Guide An Illustrated Guide to Kubernetes Networking [Part 1] An Illustrated Guide to Kubernetes Networking [Part 2] An Illustrated Guide to Kubernetes Networking [Part 3] ALB Ingress Controller on AWS EKS What Actually Happens When You Publish a Container Port","title":"Networking"},{"location":"k8s/#secrets","text":"State of Kubernetes Secrets Management in 2022 How to Set External-Secrets with AWS How to Set External-Secrets with Hashicorp Vault","title":"Secrets"},{"location":"k8s/#virtual-kubernetes","text":"Testing GitOps on Virtual Kubernetes Clusters with ArgoCD (Ephimeral k8s clusters)","title":"Virtual Kubernetes"},{"location":"k8s/#troubleshooting","text":"How to identify and troubleshoot common Kubernetes errors","title":"Troubleshooting"},{"location":"networking/","text":"Networking Tutorials and Guides Configure Router Mikrotik Replacing Router HGU Movistar/O2 This guide explains different steps for configure my router Miktrotik hEX S replacing Movistar/O2 router HGU. this one will be used as ONT only. Home Network Map This is the network map which I configured following this guide. Hard Reset This is optional. I did it because I configured this router years ago and I didn't remember which CIDR I've configured and credentials for login on it: 1. With unplugged router, press \"Reset\" button and plug it again. 2. Release the button when green SFP LED starts flashing to reset RouterOS configuration to defaults. More info 3. After router reboots, I can access to router config with IP 192.168.88.1 and credentials username: admin and no password. We need to modify our IP and set another inside CIDR 192.168.88.0/24 Change default IP address Before start to configure anything, ust to reminder that we can manage a mikrotik router with a GUI like WinBox o WebFig, or using a command line terminal. I recommend to use WinBox but I added CLI commands for apply same config just doing copy-paste. WinBox Go to IP > Addresses Select interface with name bridge Modify Address and Network . In this case: Address : 192.168.2.1/24 Network : 192.168.2.0 Click on Apply and OK Go to System > Reboot CLI Setting up a new Default IP for router on bridge interface using its id which is 0 ip/address/print where interface=bridge Columns: ADDRESS, NETWORK, INTERFACE # ADDRESS NETWORK INTERFACE ;;; defconf 0 192.168.88.1/24 192.168.88.0 bridge ip/address/set numbers=0 address=192.168.2.1/24 ip/address/print where interface=bridge Columns: ADDRESS, NETWORK, INTERFACE # ADDRESS NETWORK INTERFACE ;;; defconf 0 192.168.2.1/24 192.168.2.0 bridge Change HGU mode to bridge We need to change how our Movistar/O2 HGU router is working. At the moment is working as ONT + Router. We want to change it its mode to just working as ONT. * Connect to HGU web panel http://192.168.1.1/ * Disable DHCP service and Wi-Fi * Change mode form \" Multipuesto \" to \" Monopuesto \" * Connect cable from eth1 port of this router to eth1 port of Mikrotik router Configure VLAN Movistar/O2 uses VLANs for offer data traffic, VoIP and TV services. We just need data traffic which its VLAN ID is 6 WinBox Go to Interfaces > Select tab VLAN Click on New Set next parameters/config: Name : vlan_internet_movistar MTU : 1492 VLAN ID : 6 Interface : ether1 Click on Apply and OK CLI interface/vlan/add name=vlan_internet_movistar mtu=1492 vlan-id=6 interface=ether1 interface/vlan/print Flags: R - RUNNING Columns: NAME, MTU, ARP, VLAN-ID, INTERFACE # NAME MTU ARP VLAN-ID INTERFACE 0 R vlan_internet_movistar 1492 enabled 6 ether1 Configure PPPoE Client (WAN) PPPoE (Point-to-Point Protocol over Ethernet) is used by many ISP, Movistar/O2 too. Configuring our Mikrotik with PPPoE we're establishing an individual and authenticed session with Movistar, which will provide me a publick IP address. WinBox Go to PPP Click on New > PPPoE Client On tab/section General : Name : internet_movistar Interface : ether1 On tab/section Dial Out : User : adslppp@telefonicanetpa Password : adslppp Enable option Add Default Route Click on Apply and OK CLI interface/pppoe-client/add name=internet_movistar interface=ether1 user=adslppp@telefonicanetpa password=adslppp add-default-route=yes disabled=no interface/pppoe-client/print Flags: X - disabled, I - invalid; R - running 0 R name=\"internet_movistar\" max-mtu=auto max-mru=auto mrru=disabled interface=ether1 user=\"adslppp@telefonicanetpa> password=\"adslppp\" profile=default keepalive-timeout=10 service-name=\"\" ac-name=\"\" add-default-route=yes default-route-distance=1 dial-on-demand=no use-peer-dns=no allow=pap,chap,mschap1,mschap2 Configure DHCP Server on LAN Configure DHCP range IP which router Mikrotik will lease to different hosts. Mikrotik offer a DHCP Server configured on virtual interface bridge . I just want to set range IP. WinBox Go to IP > DHCP Server Select tab Networks and select network with name defconf : Address : 192.168.2.0/24 Gateway : 192.168.2.1 DNS servers : 192.168.2.1 Click on Apply and OK Go to IP > Pool Select IP pool named dhcp-default : Address : 192.168.2.10-192.168.2.254 Click on Apply and OK CLI ip/dhcp-server/network/set numbers=0 address=192.168.2.0/24 gateway=192.168.2.1 dns-server=192.168.2.1 ip/dhcp-server/network/print Columns: ADDRESS, GATEWAY, DNS-SERVER # ADDRESS GATEWAY DNS-SERVER ;;; defconf 0 192.168.2.0/24 192.168.2.1 192.168.2.1 ip/pool/set numbers=0 ranges=192.168.2.10-192.168.2.254 ip/pool/print Columns: NAME, RANGES, TOTAL, USED, AVAILABLE # NAME RANGES TOTAL USED AVAILABLE 0 default-dhcp 192.168.2.10-192.168.2.254 245 8 237 Configure NAT on Firewall Just check if a NAT rule for Masquerade is configured WinBox Go to IP > Firewall Select tab NAT Check if a rule exists with next config: On General Chain : srcnat Out. Interface List : WAN On Action Action : masquerade Checkbox Enabled marked If not exists, creates a new one with this config. CLI ip/firewall/nat/add chain=srcnat action=masquerade out-interface=WAN comment=\"defconf:masquerade\" ip/firewall/nat/print Flags: X - disabled, I - invalid; D - dynamic 0 ;;; defconf: masquerade chain=srcnat action=masquerade out-interface-list=WAN ipsec-policy=out,none Configure DNS Server Configure router Mikrotik as DNS server WinBox Configure DNS server Go to IP > DNS On Servers add next DNS servers: 1.1.1.1 1.0.0.1 8.8.8.8 8.8.4.4 Check option Allow Remote Requests Cache Max TTL : 06:00:00 (Optional) Add Firewall rules for DNS requests Go to IP > Firewall Check or Add a rule allowing DNS traffic for TCP and UDP Click on New : Chain : input Protocol : tcp Dst. Port : 53 Action : accept Click on Apply and OK Click on New : Chain : input Protocol : udp Dst. Port : 53 Action : accept Click on Apply and OK Check both new rules are after rule allowing ICMP requests Configure DNS by DHCP clients Go to IP > DHCP Server Go to tab Networks Select network defconf DNS Servers : 192.168.2.1 (Mikrotik local IP) Domain : lan Click on Apply and OK CLI ip/dns/set servers=\"1.1.1.1,1.0.0.1,8.8.8.8,8.8.4.4\" allow-remote-requests=yes cache-max-ttl=6h ip/dns/print ip/dns/print servers: 1.1.1.1 1.0.0.1 8.8.8.8 8.8.4.4 dynamic-servers: use-doh-server: verify-doh-cert: no doh-max-server-connections: 5 doh-max-concurrent-queries: 50 doh-timeout: 5s allow-remote-requests: yes max-udp-packet-size: 4096 query-server-timeout: 2s query-total-timeout: 10s max-concurrent-queries: 100 max-concurrent-tcp-sessions: 20 cache-size: 2048KiB cache-max-ttl: 6h address-list-extra-time: 0s vrf: main mdns-repeat-ifaces: cache-used: 120KiB Configure WireGuard VPN Mikrotik supports WireGuard VPNs since RouterOS version 7.1 , so we need to upgrade RouterOS before if our version is older. In this case, we configure a VPN connection between router Mikrotik and my Smart PHone but it could be configure with any device which supports WireGuard. This video help me a lot: https://www.youtube.com/watch?v=x409B6SO3as WinBox Starting configure a VPN WireGuard server. Go to WireGuard > New On tab General : Name : wireguard1 Listen Port : 13231 MTU : 1420 Click on Apply and Private Key and Private Key will be generated randomly Create Addres IP for new interface Go to IP > Addresses > New Configure next parameters: Enabled : marked Address : 192.168.100.1/24 Network : 192.189.100.0 Interface : wireguard1 Create Peers on server. In this case I created a peer for my mobile phone, so I've created a peer on my mobile phone. Go to WireGuard On tab Peers > New Enabled : marked Name : realme_gon interface : wireguard1 Public Key : <Public Key client created on my mobile phoen when I created a peer there> Allowed Address : 192.168.100.10/32 This IP I assigned on my phone when I created a peer there","title":"Networking"},{"location":"networking/#networking","text":"","title":"Networking"},{"location":"networking/#tutorials-and-guides","text":"","title":"Tutorials and Guides"},{"location":"networking/#configure-router-mikrotik-replacing-router-hgu-movistaro2","text":"This guide explains different steps for configure my router Miktrotik hEX S replacing Movistar/O2 router HGU. this one will be used as ONT only.","title":"Configure Router Mikrotik Replacing Router HGU Movistar/O2"},{"location":"networking/#home-network-map","text":"This is the network map which I configured following this guide.","title":"Home Network Map"},{"location":"networking/#hard-reset","text":"This is optional. I did it because I configured this router years ago and I didn't remember which CIDR I've configured and credentials for login on it: 1. With unplugged router, press \"Reset\" button and plug it again. 2. Release the button when green SFP LED starts flashing to reset RouterOS configuration to defaults. More info 3. After router reboots, I can access to router config with IP 192.168.88.1 and credentials username: admin and no password. We need to modify our IP and set another inside CIDR 192.168.88.0/24","title":"Hard Reset"},{"location":"networking/#change-default-ip-address","text":"Before start to configure anything, ust to reminder that we can manage a mikrotik router with a GUI like WinBox o WebFig, or using a command line terminal. I recommend to use WinBox but I added CLI commands for apply same config just doing copy-paste.","title":"Change default IP address"},{"location":"networking/#winbox","text":"Go to IP > Addresses Select interface with name bridge Modify Address and Network . In this case: Address : 192.168.2.1/24 Network : 192.168.2.0 Click on Apply and OK Go to System > Reboot","title":"WinBox"},{"location":"networking/#cli","text":"Setting up a new Default IP for router on bridge interface using its id which is 0 ip/address/print where interface=bridge Columns: ADDRESS, NETWORK, INTERFACE # ADDRESS NETWORK INTERFACE ;;; defconf 0 192.168.88.1/24 192.168.88.0 bridge ip/address/set numbers=0 address=192.168.2.1/24 ip/address/print where interface=bridge Columns: ADDRESS, NETWORK, INTERFACE # ADDRESS NETWORK INTERFACE ;;; defconf 0 192.168.2.1/24 192.168.2.0 bridge","title":"CLI"},{"location":"networking/#change-hgu-mode-to-bridge","text":"We need to change how our Movistar/O2 HGU router is working. At the moment is working as ONT + Router. We want to change it its mode to just working as ONT. * Connect to HGU web panel http://192.168.1.1/ * Disable DHCP service and Wi-Fi * Change mode form \" Multipuesto \" to \" Monopuesto \" * Connect cable from eth1 port of this router to eth1 port of Mikrotik router","title":"Change HGU mode to bridge"},{"location":"networking/#configure-vlan","text":"Movistar/O2 uses VLANs for offer data traffic, VoIP and TV services. We just need data traffic which its VLAN ID is 6","title":"Configure VLAN"},{"location":"networking/#winbox_1","text":"Go to Interfaces > Select tab VLAN Click on New Set next parameters/config: Name : vlan_internet_movistar MTU : 1492 VLAN ID : 6 Interface : ether1 Click on Apply and OK","title":"WinBox"},{"location":"networking/#cli_1","text":"interface/vlan/add name=vlan_internet_movistar mtu=1492 vlan-id=6 interface=ether1 interface/vlan/print Flags: R - RUNNING Columns: NAME, MTU, ARP, VLAN-ID, INTERFACE # NAME MTU ARP VLAN-ID INTERFACE 0 R vlan_internet_movistar 1492 enabled 6 ether1","title":"CLI"},{"location":"networking/#configure-pppoe-client-wan","text":"PPPoE (Point-to-Point Protocol over Ethernet) is used by many ISP, Movistar/O2 too. Configuring our Mikrotik with PPPoE we're establishing an individual and authenticed session with Movistar, which will provide me a publick IP address.","title":"Configure PPPoE Client (WAN)"},{"location":"networking/#winbox_2","text":"Go to PPP Click on New > PPPoE Client On tab/section General : Name : internet_movistar Interface : ether1 On tab/section Dial Out : User : adslppp@telefonicanetpa Password : adslppp Enable option Add Default Route Click on Apply and OK","title":"WinBox"},{"location":"networking/#cli_2","text":"interface/pppoe-client/add name=internet_movistar interface=ether1 user=adslppp@telefonicanetpa password=adslppp add-default-route=yes disabled=no interface/pppoe-client/print Flags: X - disabled, I - invalid; R - running 0 R name=\"internet_movistar\" max-mtu=auto max-mru=auto mrru=disabled interface=ether1 user=\"adslppp@telefonicanetpa> password=\"adslppp\" profile=default keepalive-timeout=10 service-name=\"\" ac-name=\"\" add-default-route=yes default-route-distance=1 dial-on-demand=no use-peer-dns=no allow=pap,chap,mschap1,mschap2","title":"CLI"},{"location":"networking/#configure-dhcp-server-on-lan","text":"Configure DHCP range IP which router Mikrotik will lease to different hosts. Mikrotik offer a DHCP Server configured on virtual interface bridge . I just want to set range IP.","title":"Configure DHCP Server on LAN"},{"location":"networking/#winbox_3","text":"Go to IP > DHCP Server Select tab Networks and select network with name defconf : Address : 192.168.2.0/24 Gateway : 192.168.2.1 DNS servers : 192.168.2.1 Click on Apply and OK Go to IP > Pool Select IP pool named dhcp-default : Address : 192.168.2.10-192.168.2.254 Click on Apply and OK","title":"WinBox"},{"location":"networking/#cli_3","text":"ip/dhcp-server/network/set numbers=0 address=192.168.2.0/24 gateway=192.168.2.1 dns-server=192.168.2.1 ip/dhcp-server/network/print Columns: ADDRESS, GATEWAY, DNS-SERVER # ADDRESS GATEWAY DNS-SERVER ;;; defconf 0 192.168.2.0/24 192.168.2.1 192.168.2.1 ip/pool/set numbers=0 ranges=192.168.2.10-192.168.2.254 ip/pool/print Columns: NAME, RANGES, TOTAL, USED, AVAILABLE # NAME RANGES TOTAL USED AVAILABLE 0 default-dhcp 192.168.2.10-192.168.2.254 245 8 237","title":"CLI"},{"location":"networking/#configure-nat-on-firewall","text":"Just check if a NAT rule for Masquerade is configured","title":"Configure NAT on Firewall"},{"location":"networking/#winbox_4","text":"Go to IP > Firewall Select tab NAT Check if a rule exists with next config: On General Chain : srcnat Out. Interface List : WAN On Action Action : masquerade Checkbox Enabled marked If not exists, creates a new one with this config.","title":"WinBox"},{"location":"networking/#cli_4","text":"ip/firewall/nat/add chain=srcnat action=masquerade out-interface=WAN comment=\"defconf:masquerade\" ip/firewall/nat/print Flags: X - disabled, I - invalid; D - dynamic 0 ;;; defconf: masquerade chain=srcnat action=masquerade out-interface-list=WAN ipsec-policy=out,none","title":"CLI"},{"location":"networking/#configure-dns-server","text":"Configure router Mikrotik as DNS server","title":"Configure DNS Server"},{"location":"networking/#winbox_5","text":"Configure DNS server Go to IP > DNS On Servers add next DNS servers: 1.1.1.1 1.0.0.1 8.8.8.8 8.8.4.4 Check option Allow Remote Requests Cache Max TTL : 06:00:00 (Optional) Add Firewall rules for DNS requests Go to IP > Firewall Check or Add a rule allowing DNS traffic for TCP and UDP Click on New : Chain : input Protocol : tcp Dst. Port : 53 Action : accept Click on Apply and OK Click on New : Chain : input Protocol : udp Dst. Port : 53 Action : accept Click on Apply and OK Check both new rules are after rule allowing ICMP requests Configure DNS by DHCP clients Go to IP > DHCP Server Go to tab Networks Select network defconf DNS Servers : 192.168.2.1 (Mikrotik local IP) Domain : lan Click on Apply and OK","title":"WinBox"},{"location":"networking/#cli_5","text":"ip/dns/set servers=\"1.1.1.1,1.0.0.1,8.8.8.8,8.8.4.4\" allow-remote-requests=yes cache-max-ttl=6h ip/dns/print ip/dns/print servers: 1.1.1.1 1.0.0.1 8.8.8.8 8.8.4.4 dynamic-servers: use-doh-server: verify-doh-cert: no doh-max-server-connections: 5 doh-max-concurrent-queries: 50 doh-timeout: 5s allow-remote-requests: yes max-udp-packet-size: 4096 query-server-timeout: 2s query-total-timeout: 10s max-concurrent-queries: 100 max-concurrent-tcp-sessions: 20 cache-size: 2048KiB cache-max-ttl: 6h address-list-extra-time: 0s vrf: main mdns-repeat-ifaces: cache-used: 120KiB","title":"CLI"},{"location":"networking/#configure-wireguard-vpn","text":"Mikrotik supports WireGuard VPNs since RouterOS version 7.1 , so we need to upgrade RouterOS before if our version is older. In this case, we configure a VPN connection between router Mikrotik and my Smart PHone but it could be configure with any device which supports WireGuard. This video help me a lot: https://www.youtube.com/watch?v=x409B6SO3as","title":"Configure WireGuard VPN"},{"location":"networking/#winbox_6","text":"Starting configure a VPN WireGuard server. Go to WireGuard > New On tab General : Name : wireguard1 Listen Port : 13231 MTU : 1420 Click on Apply and Private Key and Private Key will be generated randomly Create Addres IP for new interface Go to IP > Addresses > New Configure next parameters: Enabled : marked Address : 192.168.100.1/24 Network : 192.189.100.0 Interface : wireguard1 Create Peers on server. In this case I created a peer for my mobile phone, so I've created a peer on my mobile phone. Go to WireGuard On tab Peers > New Enabled : marked Name : realme_gon interface : wireguard1 Public Key : <Public Key client created on my mobile phoen when I created a peer there> Allowed Address : 192.168.100.10/32 This IP I assigned on my phone when I created a peer there","title":"WinBox"},{"location":"others/","text":"Others Tools and Projects D2 Declarative Diagramming: A modern diagram scripting language that turns text to diagrams JSON Crack: Seamlessly visualize your JSON data instantly into graphs. FossFLOW: Isometric Diahrams generator open-source.","title":"Others"},{"location":"others/#others","text":"","title":"Others"},{"location":"others/#tools-and-projects","text":"D2 Declarative Diagramming: A modern diagram scripting language that turns text to diagrams JSON Crack: Seamlessly visualize your JSON data instantly into graphs. FossFLOW: Isometric Diahrams generator open-source.","title":"Tools and Projects"},{"location":"terraform/","text":"Terraform Tutorials and Guides Nathan Nellan's Terraform Guide Terraform Official Documentation Elevate Your Terraform Game by leveraging for loops in Terraform Using tfsec to Scan your Terraform Code Terraform without wrappers in multi-region, multi-accounts environments Tools for Managing Terraform drift GitHub Actions: Terraform deployments with a review of planned changes Best Practices Terraform Practices: The Good, the Bad and the Ugly by Hila Fish","title":"Terraform"},{"location":"terraform/#terraform","text":"","title":"Terraform"},{"location":"terraform/#tutorials-and-guides","text":"Nathan Nellan's Terraform Guide Terraform Official Documentation Elevate Your Terraform Game by leveraging for loops in Terraform Using tfsec to Scan your Terraform Code Terraform without wrappers in multi-region, multi-accounts environments Tools for Managing Terraform drift GitHub Actions: Terraform deployments with a review of planned changes","title":"Tutorials and Guides"},{"location":"terraform/#best-practices","text":"Terraform Practices: The Good, the Bad and the Ugly by Hila Fish","title":"Best Practices"}]}